## üìò –û–ø–∏—Å–∞–Ω–∏–µ

–°–µ—Ä–≤–∏—Å –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –º–æ—à–µ–Ω–Ω–∏—á–µ—Å–∫–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö –æ–ø—Ä–µ–∞—Ü–∏—è—Ö**.  
–û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è –Ω–æ–≤—ã–µ CSV-—Ñ–∞–π–ª—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `input`, –≤—ã–ø–æ–ª—è–Ω–µ—Ç—Å—è –ø—Ä–µ–¥–æ–±—Ä–∞–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –¥–∞–ª–µ–µ –¥–µ–ª–∞–µ—Ç—Å—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –ø—Ä–∏ –ø–æ–º–æ—â–∏ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ **CatBoost**. –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `output`. –ò–º–µ–Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è. –¢–∞–∫–∂–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –≤–∞–∂–Ω–æ—Å—Ç—å topn —Ñ–∏—á–µ–π –∏ –≥—Ä–∞—Ñ–∏–∫ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö



## ‚öôÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ fraud_detector/
‚îÇ ‚îú‚îÄ‚îÄ app.py # –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å: –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤
‚îÇ ‚îú‚îÄ‚îÄ loader.py # –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫ –∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
‚îÇ ‚îú‚îÄ‚îÄ preprocessing.py # –§—É–Ω–∫—Ü–∏–∏ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞
‚îÇ ‚îú‚îÄ‚îÄ scripts.py # –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞, –∏–Ω—Ñ–µ—Ä–µ–Ω—Å –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
‚îú‚îÄ‚îÄ weights/
‚îÇ ‚îú‚îÄ‚îÄ catboost_model.cbm # –ü—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
‚îÇ ‚îú‚îÄ‚îÄ user_stats.csv # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
‚îÇ ‚îî‚îÄ‚îÄ city_stats.csv # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≥–æ—Ä–æ–¥–∞–º
‚îú‚îÄ‚îÄ input/ # –ü–∞–ø–∫–∞ –¥–ª—è –≤—Ö–æ–¥–Ω—ã—Ö CSV —Ñ–∞–π–ª–æ–≤
‚îú‚îÄ‚îÄ output/ # –ü–∞–ø–∫–∞ –¥–ª—è –≤—ã—Ö–æ–¥–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```


## –ú–æ–¥–µ–ª—å
–ú–æ–¥–µ–ª—å ‚Äî CatBoostClassifier (–≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –±—É—Å—Ç–∏–Ω–≥, Logloss, depth=7), –æ–±—É—á–µ–Ω–Ω—ã–π –Ω–∞ —á–∏—Å–ª–æ–≤—ã—Ö –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö. –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∞–≥—Ä–µ–≥–∞—Ç—ã –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é (count, mean, std, min, max, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å), –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (year, month, hour, is_weekend, is_night), –≥–µ–æ–¥–∏—Å—Ç–∞–Ω—Ü–∏—é –º–µ–∂–¥—É –º–µ—Ä—á–∞–Ω—Ç–æ–º –∏ –∫–ª–∏–µ–Ω—Ç–æ–º, –ª–æ–≥–∞—Ä–∏—Ñ–º—ã —Å—É–º–º –∏ —Ü–µ–Ω—Ç–æ–≤, –¥–ª–∏–Ω—ã –∏ —á–∞—Å—Ç–æ—Ç—ã —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø–æ–ª–µ–π, –ø–æ—á—Ç–æ–≤—ã–µ –∏–Ω–¥–µ–∫—Å—ã (zip1, zip3), –∞ —Ç–∞–∫–∂–µ –≥–æ—Ä–æ–¥—Å–∫–∏–µ —á–∞—Å—Ç–æ—Ç–Ω—ã–µ —Ñ–∏—á–∏ (city_freq, city_rareness). –ù–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –º–æ–¥–µ–ª—å –¥–æ—Å—Ç–∏–≥–ª–∞ ROC-AUC ‚âà 0.982.


## –°–±–æ—Ä–∫–∞ Docker-–æ–±—Ä–∞–∑–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Docker –≤–µ—Ä—Å–∏–∏ 20.10+
- 2 –ì–ë —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞
- Python 3.12 (–≤–∫–ª—é—á—ë–Ω –≤ –æ–±—Ä–∞–∑)

```bash
docker build -t fraud_detector .

docker run -it --rm \
  -v ./input:/app/input \
  -v ./output:/app/output \
  -e TOPN = 5
  -e ADDITIONAL_INFO = 0
  fraud_detector
```
–ü–æ—Å–ª–µ–¥–Ω–∏–µ 2 –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –º–æ–∂–Ω–æ –Ω–µ —É–∫–∞–∑—ã–≤–∞—Ç—å, –æ–Ω–∏ –∑–∞–¥–∞–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. –û–Ω–∏ –æ—Ç–≤–µ—á–∞—é—Ç –∑–∞ –∫–æ–ª-–≤–æ —Ñ–∏—á–µ–π –≤ feature importance json –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–ø. –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å–≤–µ–Ω–Ω–æ. 
## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
–ü–æ—Å–ª–µ —É–¥–∞—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –ø–æ—è–≤–∏—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ:

```
Monitoring Process in effect
```
–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ csv —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ. –¢–∞–∫–∂–µ –æ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –Ω–æ–≤—ã–µ, –¥–æ–±–∞–≤–ª—è–µ–º—ã–µ. –î–ª—è –ø—Ä–∏–º–µ—Ä–∞, –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å—å –æ–±—Ä–∞–±–æ—Ç–∫—É –Ω–∞ –∏—Å—Ö–æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ test.csv, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–ª–æ–∂–µ–Ω –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞.

–í ./output –ø–æ—è–≤—è—Ç—Å—è:
```
predict_{file name}.csv ‚Äî –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏

feature_importance.csv ‚Äî –≤–∞–∂–Ω–æ—Å—Ç–∏ topn –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ)

predict_density.png ‚Äî –≥—Ä–∞—Ñ–∏–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ)
```

## P.S.
–ü–æ—Å–ª–¥–µ–Ω–∏–π –∫–æ–º–º–∏—Ç –ø–æ—Å–ª–µ –¥–µ–¥–ª–∞–π–Ω–∞ —Ç.–∫. –∑–∞–±—ã–ª –Ω–∞–ø–∏—Å–∞—Ç—å ReadMe, –∞ —Ç–∞–∫–∂–µ –∏—Å–ø—Ä–∞–≤–∏–ª –Ω–µ–±–æ–ª—å—à—É—é –æ—à–∏–±–∫—É, –∫–æ—Ç–æ—Ä—É—é –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–µ –∑–∞–∫–æ–º–º–∏—Ç–∏–ª(—Ç–∞–º –±—É–∫–≤–∞–ª—å–Ω–æ 2 —Å—Ç—Ä–æ—á–∫–∏). –ù–∞–¥–µ—é—Å—å, —ç—Ç–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ.
–ù–æ –µ—Å–ª–∏ –≤–¥—Ä—É–≥ —ç—Ç–æ –º–æ–∂–µ—Ç –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ –æ—Ü–µ–Ω–∫—É, —Ç–æ –º–æ–≥—É –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ñ—Ñ. —Å–ø—Ä–∞–≤–∫—É –æ –±–æ–ª–µ–∑–Ω–∏ –Ω–∞ —á–∞—Å—Ç—å –¥–Ω–µ–π —ç—Ç–æ–≥–æ –¥–∑ –≤ —Ç–≥: @m_whiskas
(–û–±—ã—á–Ω–æ —É –Ω–∞—Å –≤–µ–∑–¥–µ –¥–µ–¥–ª–∞–π–Ω—ã –≤ —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –ø—Ä–æ–¥–ª–µ–≤–∞—é—Ç)
